# DHT11温湿度监测系统使用说明

## 系统功能
实现了DHT11温湿度传感器的数据读取，并在LCD1602上实时显示温度和湿度值。

## 当前实现特点

### 🌡️ **温湿度监测**
- **传感器**：DHT11数字温湿度传感器
- **连接引脚**：PE5
- **测量范围**：
  - 温度：0-50°C，精度±2°C
  - 湿度：20-90%RH，精度±5%RH
- **采样频率**：每2秒更新一次

### 📺 **LCD显示**
- **显示格式**：
  - 第一行：`Temp: XXC  Humi: XX%`
  - 第二行：`Read: X times`
- **实时更新**：每2秒刷新显示
- **错误显示**：当传感器故障时显示错误信息

### 💡 **LED状态指示**
- **LED0**：数据读取状态
  - 正常：缓慢闪烁一次
  - 异常：快速闪烁三次
- **LED1**：系统启动指示
  - 启动时闪烁3次
  - 错误时快速闪烁

## 程序执行流程

### 1. 初始化阶段
```
系统启动 → LED1闪烁3次 → LCD初始化 → DHT11初始化 → 显示启动信息 → LED0快闪5次
```

### 2. 正常运行阶段
```
读取DHT11数据 → 格式化数据 → LCD显示 → LED0闪烁 → 延时2秒 → 循环
```

### 3. 错误处理阶段
```
读取失败 → 显示错误信息 → LED1快闪 → 重试计数 → 超过5次重新初始化DHT11
```

## 关键代码解析

### DHT11数据读取
```c
unsigned char temperature, humidity;
if(DHT11_ReadData(&temperature, &humidity) == 0)  // 读取成功
{
    // 格式化显示字符串
    sprintf(temp_str, "Temp: %d C", temperature);
    sprintf(humi_str, "Humi: %d%%", humidity);
    
    // LCD显示
    lcd_print_str(0, 0, temp_str);
    lcd_print_str(1, 0, humi_str);
}
```

### 错误处理机制
```c
else  // 读取失败
{
    error_count++;
    lcd_print_str(0, 0, "DHT11 Error!");
    
    // 连续错误太多时重新初始化
    if(error_count >= 5) {
        DHT11_Init();
        error_count = 0;
    }
}
```

## 硬件连接说明

### DHT11连接
- **VCC** → 3.3V 或 5V
- **DATA** → PE5
- **GND** → 地线
- **注意**：DATA引脚需要4.7kΩ上拉电阻

### LCD1602连接
- **控制线**：RS→PB7, RW→PD6, EN→PA4
- **数据线**：D0-D7按头文件定义连接
- **电源**：VCC→5V, GND→地

### LED连接
- **LED0** → PF9
- **LED1** → PF10

## 显示效果示例

### 正常显示
```
Temp: 25C  Humi: 60%
Read: 15 times
```

### 错误显示
```
DHT11 Error!
Retry: 3
```

### 初始化显示
```
Temp&Humi Sensor
Initializing...
```

## 故障排除

### 1. DHT11读取失败
**可能原因：**
- 硬件连接不正确
- 上拉电阻缺失
- 传感器损坏
- 电源电压不稳定

**解决方法：**
- 检查PE5引脚连接
- 确认4.7kΩ上拉电阻
- 检查电源电压（3.3V或5V）
- 更换DHT11传感器

### 2. LCD显示异常
**可能原因：**
- LCD初始化失败
- 显示字符串格式错误

**解决方法：**
- 检查LCD连接
- 确认延时函数正常工作
- 检查字符串格式

### 3. 数据显示不更新
**可能原因：**
- DHT11通信失败
- 主循环卡死

**解决方法：**
- 观察LED状态指示
- 检查延时函数工作
- 重新上电复位

## 性能参数

- **数据更新频率**：0.5Hz（每2秒）
- **温度精度**：±2°C
- **湿度精度**：±5%RH
- **响应时间**：约2秒
- **功耗**：约15mA（含LCD背光）

## 扩展功能建议

1. **数据记录**：添加温湿度历史数据记录
2. **阈值报警**：设置温湿度阈值报警
3. **通信接口**：添加串口或无线通信
4. **显示优化**：添加小数位显示
5. **节能模式**：添加低功耗待机模式

## 注意事项

1. **DHT11限制**：连续读取间隔不能少于2秒
2. **上拉电阻**：DATA引脚必须有4.7kΩ上拉电阻
3. **电源稳定**：确保电源电压稳定，避免传感器工作异常
4. **环境要求**：避免在极端温湿度环境下使用
5. **静电防护**：操作时注意静电防护，避免损坏传感器

当前实现已经包含了基本的错误处理和状态指示，可以可靠地监测和显示环境温湿度数据。
