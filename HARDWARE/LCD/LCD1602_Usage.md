# LCD1602驱动使用说明

## 功能概述
本驱动实现了STM32F407与LCD1602液晶显示屏的接口控制，支持显示字符和字符串。

## 硬件连接
根据项目文档，LCD1602通过camera接口连接到STM32F407，具体引脚连接如下：

| LCD引脚 | STM32引脚 | 功能说明 |
|---------|-----------|----------|
| VSS     | GND       | 电源地 |
| VDD     | 3.3V      | 电源正极 |
| V0      | GND       | 对比度调节(接GND为最大对比度) |
| RS      | PB7       | 寄存器选择(0=指令,1=数据) |
| RW      | PD6       | 读写选择(0=写,1=读) |
| E       | PA4       | 使能信号(高电平有效) |
| D0      | PD7       | 数据位0 |
| D1      | PG15      | 数据位1 |
| D2      | PC6       | 数据位2 |
| D3      | PC7       | 数据位3 |
| D4      | PC8       | 数据位4 |
| D5      | PC9       | 数据位5 |
| D6      | PC11      | 数据位6 |
| D7      | PB6       | 数据位7 |
| A       | +5V       | 背光正极 |
| K       | GND       | 背光负极 |

## API函数说明

### 1. lcd_init(void)
**功能**: 初始化LCD1602显示屏
**参数**: 无
**返回值**: 无
**说明**: 必须在使用LCD之前调用此函数

### 2. lcd_clear(void)
**功能**: 清除LCD显示内容
**参数**: 无
**返回值**: 无

### 3. lcd_gotoxy(unsigned char line, unsigned char column)
**功能**: 设置光标位置
**参数**: 
- line: 行号(0-第一行, 1-第二行)
- column: 列号(0-15)
**返回值**: 无

### 4. lcd_print_str(unsigned char *str)
**功能**: 在当前光标位置显示字符串
**参数**: str - 要显示的字符串指针
**返回值**: 无

### 5. lcd_print_char(unsigned char ch)
**功能**: 在当前光标位置显示单个字符
**参数**: ch - 要显示的字符
**返回值**: 无

### 6. lcd_write_cmd(unsigned char cmd)
**功能**: 向LCD写入指令(底层函数)
**参数**: cmd - 指令代码
**返回值**: 无

### 7. lcd_write_dat(unsigned char dat)
**功能**: 向LCD写入数据(底层函数)
**参数**: dat - 数据
**返回值**: 无

## 使用示例

```c
#include "lcd.h"
#include "delay.h"

int main(void)
{
    // 初始化延时函数
    delay_init();
    
    // 初始化LCD
    lcd_init();
    
    // 清屏
    lcd_clear();
    
    // 在第一行显示"Student ID:"
    lcd_gotoxy(0, 0);
    lcd_print_str("Student ID:");
    
    // 在第二行显示学号
    lcd_gotoxy(1, 0);
    lcd_print_str("2021001234");
    
    while(1)
    {
        // 主循环
    }
}
```

## 注意事项

1. **延时初始化**: 使用LCD之前必须先调用`delay_init()`初始化延时函数
2. **LCD初始化**: 使用LCD任何功能之前必须先调用`lcd_init()`
3. **字符限制**: LCD1602每行最多显示16个字符，共2行
4. **字符编码**: 支持ASCII字符显示
5. **电源要求**: 确保3.3V和5V电源稳定供电
6. **引脚连接**: 请严格按照引脚定义进行硬件连接

## 常见问题解决

1. **显示乱码**: 检查引脚连接是否正确，特别是数据线D0-D7
2. **无显示**: 检查电源连接和对比度设置(V0引脚)
3. **显示不全**: 检查背光连接(A, K引脚)
4. **程序卡死**: 检查延时函数是否正确初始化

## 文件结构
- `lcd.h`: 头文件，包含函数声明和宏定义
- `lcd.c`: 源文件，包含所有LCD驱动函数的实现
- `delay.h/delay.c`: 延时函数，LCD驱动的依赖
