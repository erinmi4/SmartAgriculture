# DHT11温湿度传感器使用说明

## 功能实现

本程序实现了DHT11温湿度传感器的数据读取和LCD1602显示功能。

## 显示格式

### LCD显示内容 (16x2)
```
第一行: Temp: XX'C      (温度显示)
第二行: Humi: XX%RH     (湿度显示)
```

### 显示示例
**正常状态**:
```
Temp: 23'C
Humi: 65%RH
```

**错误状态**:
```
DHT11 Read
Error!
```

## 传感器配置

### DHT11温湿度传感器
- **接口**: PE5 (单总线)
- **供电**: 3.3V/5V
- **测量范围**: 
  - 温度: 0-50°C (精度±2°C)
  - 湿度: 20-90%RH (精度±5%RH)
- **更新频率**: 2秒

## 主要函数

### DHT11相关函数
- `dht11_init()` - DHT11传感器初始化
- `dht11_read_dat(unsigned char *temp, unsigned char *humi)` - 读取温湿度数据
  - 返回值：0=成功，1=失败
  - 参数：temp=温度指针，humi=湿度指针

### LCD相关函数
- `lcd_init()` - LCD1602初始化
- `lcd_print_str(line, column, str)` - 在指定位置显示字符串
- `lcd_gotoxy(line, column)` - 设置光标位置（可选）

### 延时函数
- `Mdelay_Lib(ms)` - 毫秒级延时

### 1. 实时监测
- 温度实时检测和显示
- 湿度实时检测和显示
- 自动错误处理

### 2. 简洁显示
- 清晰的温度和湿度显示
- 读取失败时显示错误信息
- 2秒自动更新

### 3. 稳定性
- DHT11通信协议处理
- 数据校验机制
- 错误重试机制

## 硬件连接

### DHT11传感器引脚
- **VCC** → 3.3V 或 5V
- **GND** → GND
- **DATA** → PE5

### LCD1602
- 按照lcd.h中的引脚定义连接

## 代码特点

### 1. 简洁设计
- 仅包含DHT11功能
- 使用现有的DHT11.c库
- 集成在main.c中，避免链接问题

### 2. 可靠性
- 完善的错误处理
- 数据校验和验证
- 通信超时保护

### 3. 易用性
- 直观的温湿度显示
- 错误状态提示
- 自动重试机制

## 使用方法

1. **硬件连接**: 按照上述引脚定义连接DHT11和LCD
2. **编译下载**: 编译main.c并下载到STM32F407
3. **运行观察**: 上电后LCD显示温湿度数据

## 工作流程

1. **系统初始化**: 初始化DHT11、LCD等外设
2. **显示启动信息**: "DHT11 Starting..."
3. **循环读取**: 每2秒读取一次温湿度
4. **数据显示**: 在LCD上显示温度和湿度
5. **错误处理**: 读取失败时显示错误信息

## 注意事项

1. **连接稳定**: 确保DHT11的DATA线连接稳定
2. **供电充足**: 确保DHT11供电稳定
3. **读取间隔**: DHT11需要至少2秒的读取间隔
4. **环境条件**: 在测量范围内使用传感器

## 故障排除

### 常见问题
1. **显示"Error!"**: 
   - 检查DHT11连接
   - 确认PE5引脚配置
   - 检查供电电压

2. **数据不更新**:
   - 检查延时函数是否正常
   - 确认DHT11_ReadData返回值

3. **LCD无显示**:
   - 检查LCD连接
   - 确认lcd_init()是否成功

4. **编译链接错误**:
   - 如果出现`MQ2_ProcessData`未定义错误
   - 需要修改uart.c，移除MQ-2相关代码
   - 已在本项目中修复

5. **函数名不匹配错误**:
   - 如果出现`DHT11_Init`、`DHT11_ReadData`未定义错误
   - 检查DHT11.h中的实际函数名
   - 应使用`dht11_init()`和`dht11_read_dat()`

### 解决的编译问题
- **问题1**: `Undefined symbol MQ2_ProcessData`
- **原因**: uart.c中调用了不存在的MQ2函数
- **解决**: 移除uart.c中的MQ-2处理代码，恢复默认echo功能

- **问题2**: `Undefined symbol DHT11_Init`, `DHT11_ReadData`
- **原因**: 函数名大小写不匹配
- **解决**: 使用正确的小写函数名`dht11_init()`、`dht11_read_dat()`

## 扩展功能建议

1. **数据记录**: 保存温湿度历史数据
2. **阈值报警**: 设置温湿度报警阈值
3. **数据上传**: 通过串口或WiFi上传数据
4. **更多传感器**: 添加其他环境传感器

这个简洁的DHT11监测系统提供了可靠的温湿度监测功能！
