# 蓝牙数字命令使用说明

## 概述
为了简化调试，蓝牙命令系统已改为简单的数字命令格式。发送单个数字即可执行相应的阈值修改操作。

## 命令列表

### 阈值设置命令
- **命令 1**: 设置温度高阈值为35℃
- **命令 2**: 设置温度低阈值为15℃  
- **命令 3**: 设置湿度高阈值为80%
- **命令 4**: 设置湿度低阈值为30%
- **命令 5**: 设置光照低阈值为30%
- **命令 6**: 设置烟雾高阈值为200ppm

### 测试和控制命令
- **命令 7**: 强制触发报警测试（用于测试蜂鸣器和LED）
- **命令 8**: 关闭所有报警
- **命令 9**: 查询当前状态和阈值
- **命令 0**: 恢复所有默认阈值

## 使用方法

### 1. 连接蓝牙
- 系统启动后会自动发送蓝牙就绪消息
- 蓝牙波特率：9600

### 2. 发送命令
直接发送数字字符即可，例如：
```
发送: 1
返回: RECEIVED CMD: 1
      SUCCESS: TempHigh=35C
      COMPLETE
```

### 3. 测试蜂鸣器
```
发送: 7
返回: RECEIVED CMD: 7
      SUCCESS: Alarm Test ON
      COMPLETE
```
此时蜂鸣器应该开始响起，LED也会亮起。

### 4. 关闭报警
```
发送: 8
返回: RECEIVED CMD: 8
      SUCCESS: All Alarms OFF
      COMPLETE
```

### 5. 查询状态
```
发送: 9
返回: RECEIVED CMD: 9
      STATUS: T=25C(15-35) H=60%(30-80) L=50%(30) S=45ppm(200) A=NO
```

## 自定义修改

如需修改阈值的具体数值，请编辑 `main.c` 文件中的 `Bluetooth_ParseCommand` 函数：

```c
case 1: // 设置温度高阈值
    thresholds.temp_high = 35;  // 修改这个数值
    sprintf(response, "SUCCESS: TempHigh=35C\r\n");
    LCD_ShowNotification("TempHigh: 35C", 2000);
    break;
```

## 调试信息

系统会在以下情况发送消息：
- 每10秒发送心跳包：`HEARTBEAT: T=25C H=60% S=45ppm`
- 收到命令时：`RECEIVED CMD: X`
- 执行成功时：`SUCCESS: ...`
- 完成处理时：`COMPLETE`

## 故障排除

1. **蓝牙无反应**：
   - 检查蓝牙模块连接
   - 确认波特率为9600
   - 等待系统发送就绪消息

2. **蜂鸣器不响**：
   - 发送命令 `7` 强制测试
   - 检查 `ENABLE_ALARM` 是否为1
   - 确认蜂鸣器硬件连接

3. **阈值不生效**：
   - 发送命令 `9` 查看当前阈值
   - 发送命令 `0` 重置后重新设置

## 心跳监控
系统每10秒自动发送状态信息，用于监控连接：
```
HEARTBEAT: T=25C H=60% S=45ppm
```
