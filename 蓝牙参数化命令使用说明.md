# 蓝牙参数化命令使用说明

## 功能概述
STM32智慧农业系统现在支持通过蓝牙发送参数化命令来动态修改各类传感器的报警阈值。修改成功后，LCD屏幕会显示2秒钟的确认提示信息。

## 命令格式
所有命令采用统一格式：`命令类型:数值`

### 支持的命令类型

| 命令 | 说明 | 数值范围 | 示例 |
|------|------|----------|------|
| TH:xx | 设置温度高阈值 | 0-60°C | `TH:35` |
| TL:xx | 设置温度低阈值 | 0-60°C | `TL:15` |
| HH:xx | 设置湿度高阈值 | 0-100% | `HH:80` |
| HL:xx | 设置湿度低阈值 | 0-100% | `HL:30` |
| LL:xx | 设置光照低阈值 | 0-100% | `LL:25` |
| SH:xx | 设置烟雾高阈值 | 0-1000ppm | `SH:200` |

## 使用步骤

### 1. 连接蓝牙模块
- 确保蓝牙模块已配对连接
- 波特率：9600
- 数据位：8位，停止位：1位，无校验

### 2. 发送命令
在蓝牙调试工具（如串口助手、手机蓝牙终端）中输入命令，例如：
```
TH:30
```

### 3. 确认反馈
系统会通过蓝牙返回确认信息：
```
TempHigh set to 30 C
```

### 4. LCD提示显示
LCD屏幕会显示2秒钟的英文提示信息：
```
TempHigh: 30C
```

## 错误处理

### 命令格式错误
如果命令格式不正确，系统返回：
```
Error: Invalid format
```

### 数值超出范围
如果设置的数值超出允许范围，系统返回相应错误信息，例如：
```
Error: Temp range 0-60C
Error: Humi range 0-100%
Error: Light range 0-100%
Error: Smoke range 0-1000ppm
```

### 未知命令
如果发送了不支持的命令类型，系统返回：
```
Error: Unknown command
Available: TH/TL/HH/HL/LL/SH
```

## 实际应用示例

### 场景1：调整温度报警范围
在夏季高温时期，可能需要调高温度报警阈值：
```
发送: TH:35
返回: TempHigh set to 35 C
LCD显示: TempHigh: 35C (显示2秒)
```

### 场景2：调整烟雾灵敏度
在需要更敏感检测的环境中：
```
发送: SH:150
返回: SmokeHigh set to 150 ppm
LCD显示: SmokeHigh: 150ppm (显示2秒)
```

### 场景3：调整湿度控制范围
根据作物需求调整湿度范围：
```
发送: HH:75
返回: HumiHigh set to 75%
LCD显示: HumiHigh: 75% (显示2秒)

发送: HL:45
返回: HumiLow set to 45%
LCD显示: HumiLow: 45% (显示2秒)
```

## 技术特点

1. **简化设计**：删除了所有不相关的蓝牙功能，只保留阈值修改功能
2. **参数化命令**：支持灵活的参数设置，不再局限于预设值
3. **实时反馈**：蓝牙确认信息和LCD英文提示双重反馈
4. **范围检查**：自动验证参数合法性，防止无效设置
5. **用户友好**：LCD显示简洁的英文提示信息，界面清晰

## 注意事项

1. 每次修改阈值后，新的阈值会立即生效，影响报警判断
2. LCD提示信息会覆盖当前页面显示，持续2秒后自动恢复
3. 所有阈值修改都会被保存在内存中，但重启后会恢复默认值
4. 蓝牙命令不区分大小写，但建议使用大写字母以保持一致性

## 故障排除

1. **无蓝牙响应**：检查蓝牙连接状态和波特率设置
2. **LCD无提示**：确认系统正常运行，检查显示更新循环
3. **阈值未生效**：检查命令格式和数值范围是否正确
4. **英文显示异常**：确认LCD支持英文字符显示
